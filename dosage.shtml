<html>
<body>

<head>
<link rel="stylesheet" href="plink.css" type="text/css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<title>PLINK: Whole genome data analysis toolset</title>
</head>



<!--<html>-->
<!--<title>PLINK</title>-->
<!--<body>-->

<font size="6" color="darkgreen"><b>plink...</b></font>

<div style="position:absolute;right:10px;top:10px;font-size: 
75%"><em>Last original <tt>PLINK</tt> release is <b>v1.07</b>
(10-Oct-2009); <b>PLINK 1.9</b> is now <a href="plink2.shtml"> available</a> for beta-testing</em></div>

<h1>Whole genome association analysis toolset</h1>

<font size="1" color="darkgreen">
<em>
<a href="index.shtml">Introduction</a> |
<a href="contact.shtml">Basics</a> |
<a href="download.shtml">Download</a> |
<a href="reference.shtml">Reference</a> |
<a href="data.shtml">Formats</a> |
<a href="dataman.shtml">Data management</a> |
<a href="summary.shtml">Summary stats</a> |
<a href="thresh.shtml">Filters</a> |
<a href="strat.shtml">Stratification</a> |
<a href="ibdibs.shtml">IBS/IBD</a> |
<a href="anal.shtml">Association</a> |
<a href="fanal.shtml">Family-based</a> |
<a href="perm.shtml">Permutation</a> |
<a href="ld.shtml">LD calcualtions</a> |
<a href="haplo.shtml">Haplotypes</a> |
<a href="whap.shtml">Conditional tests</a> |
<a href="proxy.shtml">Proxy association</a> |
<a href="pimputation.shtml">Imputation</a> |
<a href="dosage.shtml">Dosage data</a> |
<a href="metaanal.shtml">Meta-analysis</a> |
<a href="annot.shtml">Result annotation</a> |
<a href="clump.shtml">Clumping</a> |
<a href="grep.shtml">Gene Report</a> |
<a href="epi.shtml">Epistasis</a> |
<a href="cnv.shtml">Rare CNVs</a> |
<a href="gvar.shtml">Common CNPs</a> |
<a href="rfunc.shtml">R-plugins</a> |
<a href="psnp.shtml">SNP annotation</a> |
<a href="simulate.shtml">Simulation</a> |
<a href="profile.shtml">Profiles</a> |
<a href="ids.shtml">ID helper</a> |
<a href="res.shtml">Resources</a> |
<a href="flow.shtml">Flow chart</a> | 
<a href="misc.shtml">Misc.</a> |
<a href="faq.shtml">FAQ</a> |
<a href="gplink.shtml">gPLINK</a> 
</em></font>
</p>


<table border=0>
<tr>


<td bgcolor="lightblue" valign="top" width=20%>

<font size="1">

<a href="index.shtml">1. Introduction</a> </p>

<a href="contact.shtml">2. Basic information</a> </p>
<ul> 
 <li> <a href="contact.shtml#cite">Citing PLINK</a>
 <li> <a href="contact.shtml#probs">Reporting problems</a>
 <li> <a href="news.shtml">What's new?</a>
 <li> <a href="pdf.shtml">PDF documentation</a>
</ul>


<a href="download.shtml">3. Download and general notes</a> </p>
<ul> 
 <li> <a href="download.shtml#download">Stable download</a>
 <li> <a href="download.shtml#latest">Development code</a>
 <li> <a href="download.shtml#general">General notes</a>
 <li> <a href="download.shtml#msdos">MS-DOS notes</a>
 <li> <a href="download.shtml#nix">Unix/Linux notes</a>
 <li> <a href="download.shtml#compilation">Compilation</a>
 <li> <a href="download.shtml#input">Using the command line</a>
 <li> <a href="download.shtml#output">Viewing output files</a>
 <li> <a href="changelog.shtml">Version history</a>
</ul>

<a href="reference.shtml">4. Command reference table</a> </p>
<ul> 
 <li> <a href="reference.shtml#options">List of options</a>
 <li> <a href="reference.shtml#output">List of output files</a> 
 <li> <a href="newfeat.shtml">Under development</a>
</ul>


<a href="data.shtml">5. Basic usage/data formats</a> 
<ul> 
 <li> <a href="data.shtml#plink">Running PLINK</a>
 <li> <a href="data.shtml#ped">PED files</a>
 <li> <a href="data.shtml#map">MAP files</a>
 <li> <a href="data.shtml#tr">Transposed filesets</a>
 <li> <a href="data.shtml#long">Long-format filesets</a>
 <li> <a href="data.shtml#bed">Binary PED files</a>
 <li> <a href="data.shtml#pheno">Alternate phenotypes</a>
 <li> <a href="data.shtml#covar">Covariate files</a>
 <li> <a href="data.shtml#clst">Cluster files</a>
 <li> <a href="data.shtml#sets">Set files</a>
</ul>

<a href="dataman.shtml">6. Data management</a> </p>
<ul>
 <li>  <a href="dataman.shtml#recode">Recode</a>
 <li>  <a href="dataman.shtml#recode">Reorder</a>
 <li>  <a href="dataman.shtml#snplist">Write SNP list</a>
 <li>  <a href="dataman.shtml#updatemap">Update SNP map</a>
 <li>  <a href="dataman.shtml#updateallele">Update allele information</a>
 <li>  <a href="dataman.shtml#refallele">Force reference allele</a>
 <li>  <a href="dataman.shtml#updatefam">Update individuals</a>
 <li>  <a href="dataman.shtml#wrtcov">Write covariate files</a>
 <li>  <a href="dataman.shtml#wrtclst">Write cluster files</a>
 <li>  <a href="dataman.shtml#flip">Flip strand</a>
 <li>  <a href="dataman.shtml#flipscan">Scan for strand problem</a>
 <li>  <a href="dataman.shtml#merge">Merge two files</a>
 <li>  <a href="dataman.shtml#mergelist">Merge multiple files</a>
 <li>  <a href="dataman.shtml#extract">Extract SNPs</a>
 <li>  <a href="dataman.shtml#exclude">Remove SNPs</a>
 <li>  <a href="dataman.shtml#zero">Zero out sets of genotypes</a>
 <li>  <a href="dataman.shtml#keep">Extract Individuals</a>
 <li>  <a href="dataman.shtml#remove">Remove Individuals</a>
 <li>  <a href="dataman.shtml#filter">Filter Individuals</a>
 <li>  <a href="dataman.shtml#attrib">Attribute filters</a>
 <li>  <a href="dataman.shtml#makeset">Create a set file</a>
 <li>  <a href="dataman.shtml#tabset">Tabulate SNPs by sets</a>
 <li>  <a href="dataman.shtml#snp-qual">SNP quality scores</a>
 <li>  <a href="dataman.shtml#geno-qual">Genotypic quality scores</a>
</ul>
 
<a href="summary.shtml">7. Summary stats</a>
<ul>
 <li> <a href="summary.shtml#missing">Missingness</a>
 <li> <a href="summary.shtml#oblig_missing">Obligatory missingness</a>
 <li> <a href="summary.shtml#clustermissing">IBM clustering</a>
 <li> <a href="summary.shtml#testmiss">Missingness by phenotype</a>
 <li> <a href="summary.shtml#mishap">Missingness by genotype</a>
 <li> <a href="summary.shtml#hardy">Hardy-Weinberg</a>
 <li> <a href="summary.shtml#freq">Allele frequencies</a>
 <li> <a href="summary.shtml#prune">LD-based SNP pruning</a>
 <li> <a href="summary.shtml#mendel">Mendel errors</a>
 <li> <a href="summary.shtml#sexcheck">Sex check</a>
 <li> <a href="summary.shtml#pederr">Pedigree errors</a>
</ul>

<a href="thresh.shtml">8. Inclusion thresholds</a>
<ul>
 <li> <a href="thresh.shtml#miss2">Missing/person</a>
 <li> <a href="thresh.shtml#maf">Allele frequency</a>
 <li> <a href="thresh.shtml#miss1">Missing/SNP</a>
 <li> <a href="thresh.shtml#hwd">Hardy-Weinberg</a>
 <li> <a href="thresh.shtml#mendel">Mendel errors</a>
</ul>


<a href="strat.shtml">9. Population stratification</a>
<ul>
 <li> <a href="strat.shtml#cluster">IBS clustering</a>
 <li> <a href="strat.shtml#permtest">Permutation test</a>
 <li> <a href="strat.shtml#options">Clustering options</a>
 <li> <a href="strat.shtml#matrix">IBS matrix</a>
 <li> <a href="strat.shtml#mds">Multidimensional scaling</a>
 <li> <a href="strat.shtml#outlier">Outlier detection</a>
</ul>

<a href="ibdibs.shtml">10. IBS/IBD estimation</a>
<ul>
 <li> <a href="ibdibs.shtml#genome">Pairwise IBD</a>
 <li> <a href="ibdibs.shtml#inbreeding">Inbreeding</a>
 <li> <a href="ibdibs.shtml#homo">Runs of homozygosity</a>
 <li> <a href="ibdibs.shtml#segments">Shared segments</a>
</ul>


<a href="anal.shtml">11. Association</a>
<ul>
 <li> <a href="anal.shtml#cc">Case/control</a>
 <li> <a href="anal.shtml#fisher">Fisher's exact</a>
 <li> <a href="anal.shtml#model">Full model</a>
 <li> <a href="anal.shtml#strat">Stratified analysis</a>
 <li> <a href="anal.shtml#homog">Tests of heterogeneity</a>
 <li> <a href="anal.shtml#hotel">Hotelling's T(2) test</a>
 <li> <a href="anal.shtml#qt">Quantitative trait</a>
 <li> <a href="anal.shtml#qtmeans">Quantitative trait means</a>
 <li> <a href="anal.shtml#qtgxe">Quantitative trait GxE</a>
 <li> <a href="anal.shtml#glm">Linear and logistic models</a>
 <li> <a href="anal.shtml#set">Set-based tests</a>
 <li> <a href="anal.shtml#adjust">Multiple-test correction</a>
</ul>

<a href="fanal.shtml">12. Family-based association</a>
<ul>
 <li> <a href="fanal.shtml#tdt">TDT</a>
 <li> <a href="fanal.shtml#ptdt">ParenTDT</a>
 <li> <a href="fanal.shtml#poo">Parent-of-origin</a>
 <li> <a href="fanal.shtml#dfam">DFAM test</a>
 <li> <a href="fanal.shtml#qfam">QFAM test</a>
</ul>

<a href="perm.shtml">13. Permutation procedures</a>
<ul>
 <li> <a href="perm.shtml#perm">Basic permutation</a>
 <li> <a href="perm.shtml#aperm">Adaptive permutation</a>
 <li> <a href="perm.shtml#mperm">max(T) permutation</a>
 <li> <a href="perm.shtml#rank">Ranked permutation</a>
 <li> <a href="perm.shtml#genedropmodel">Gene-dropping</a>
 <li> <a href="perm.shtml#cluster">Within-cluster</a>
 <li> <a href="perm.shtml#mkphe">Permuted phenotypes files</a>
</ul>

<a href="ld.shtml">14. LD calculations</a>
<ul>
 <li> <a href="ld.shtml#ld1">2 SNP pairwise LD</a>
 <li> <a href="ld.shtml#ld2">N SNP pairwise LD</a>
 <li> <a href="ld.shtml#tags">Tagging options</a>
 <li> <a href="ld.shtml#blox">Haplotype blocks</a>
</ul>

<a href="haplo.shtml">15. Multimarker tests</a>
<ul>
 <li> <a href="haplo.shtml#hap1">Imputing haplotypes</a>
 <li> <a href="haplo.shtml#precomputed">Precomputed lists</a>
 <li> <a href="haplo.shtml#hap2">Haplotype frequencies</a>
 <li> <a href="haplo.shtml#hap3">Haplotype-based association</a>
 <li> <a href="haplo.shtml#hap3c">Haplotype-based GLM tests</a>
 <li> <a href="haplo.shtml#hap3b">Haplotype-based TDT</a>
 <li> <a href="haplo.shtml#hap4">Haplotype imputation</a>
 <li> <a href="haplo.shtml#hap5">Individual phases</a>
</ul>

<a href="whap.shtml">16. Conditional haplotype tests</a>
<ul>
 <li> <a href="whap.shtml#whap1">Basic usage</a>
 <li> <a href="whap.shtml#whap2">Specifying type of test</a>
 <li> <a href="whap.shtml#whap3">General haplogrouping</a>
 <li> <a href="whap.shtml#whap4">Covariates and other SNPs</a>
</ul>

<a href="proxy.shtml">17. Proxy association</a>
<ul>
 <li> <a href="proxy.shtml#proxy1">Basic usage</a>
 <li> <a href="proxy.shtml#proxy2">Refining a signal</a>
 <li> <a href="proxy.shtml#proxy2b">Multiple reference SNPs</a>
 <li> <a href="proxy.shtml#proxy3">Haplotype-based SNP tests</a>
</ul>

<a href="pimputation.shtml">18. Imputation (beta)</a>
<ul>
 <li> <a href="pimputation.shtml#impute1">Making reference set</a>
 <li> <a href="pimputation.shtml#impute2">Basic association test</a>
 <li> <a href="pimputation.shtml#impute3">Modifying parameters</a>
 <li> <a href="pimputation.shtml#impute4">Imputing discrete calls</a>
 <li> <a href="pimputation.shtml#impute5">Verbose output options</a>
</ul>

<a href="dosage.shtml">19. Dosage data</a>
<ul>
 <li> <a href="dosage.shtml#format">Input file formats</a>
 <li> <a href="dosage.shtml#assoc">Association analysis</a>
 <li> <a href="dosage.shtml#output">Outputting dosage data</a>
</ul>

<a href="metaanal.shtml">20. Meta-analysis</a>
<ul>
 <li> <a href="metaanal.shtml#basic">Basic usage</a>
 <li> <a href="metaanal.shtml#opt">Misc. options</a>
</ul>

<a href="annot.shtml">21. Annotation</a>
<ul>
 <li> <a href="annot.shtml#basic">Basic usage</a>
 <li> <a href="annot.shtml#opt">Misc. options</a>
</ul>

<a href="clump.shtml">22. LD-based results clumping</a>
<ul>
 <li> <a href="clump.shtml#clump1">Basic usage</a>
 <li> <a href="clump.shtml#clump2">Verbose reporting</a>
 <li> <a href="clump.shtml#clump3">Combining multiple studies</a>
 <li> <a href="clump.shtml#clump4">Best single proxy</a>
</ul>

<a href="grep.shtml">23. Gene-based report</a>
<ul>
 <li> <a href="grep.shtml#grep1">Basic usage</a>
 <li> <a href="grep.shtml#grep2">Other options</a>
</ul>

<a href="epi.shtml">24. Epistasis</a>
<ul>
 <li> <a href="epi.shtml#snp">SNP x SNP</a>
 <li> <a href="epi.shtml#case">Case-only</a>
 <li> <a href="epi.shtml#gene">Gene-based</a>
</ul>

<a href="cnv.shtml">25. Rare CNVs</a>
<ul>
 <li> <a href="cnv.shtml#format">File format</a>
 <li> <a href="cnv.shtml#maps">MAP file construction</a>
 <li> <a href="cnv.shtml#loading">Loading CNVs</a>
 <li> <a href="cnv.shtml#olap_check">Check for overlap</a>
 <li> <a href="cnv.shtml#type_filter">Filter on type </a>
 <li> <a href="cnv.shtml#gene_filter">Filter on genes </a> 
 <li> <a href="cnv.shtml#freq_filter">Filter on frequency </a>
 <li> <a href="cnv.shtml#burden">Burden analysis</a>
 <li> <a href="cnv.shtml#burden2">Geneset enrichment</a>
 <li> <a href="cnv.shtml#assoc">Mapping loci</a>
 <li> <a href="cnv.shtml#reg-assoc">Regional tests</a>
 <li> <a href="cnv.shtml#qt-assoc">Quantitative traits</a>
 <li> <a href="cnv.shtml#write_cnvlist">Write CNV lists</a>
 <li> <a href="cnv.shtml#report">Write gene lists</a>
 <li> <a href="cnv.shtml#groups">Grouping CNVs </a>
</ul>

<a href="gvar.shtml">26. Common CNPs</a>
<ul>
 <li> <a href="gvar.shtml#cnv2"> CNPs/generic variants</a>
 <li> <a href="gvar.shtml#cnv2b"> CNP/SNP association</a>
</ul>


<a href="rfunc.shtml">27. R-plugins</a>
<ul>
 <li> <a href="rfunc.shtml#rfunc1">Basic usage</a>
 <li> <a href="rfunc.shtml#rfunc2">Defining the R function</a>
 <li> <a href="rfunc.shtml#rfunc2b">Example of debugging</a>
 <li> <a href="rfunc.shtml#rfunc3">Installing Rserve</a>
</ul>


<a href="psnp.shtml">28. Annotation web-lookup</a>
<ul>
 <li> <a href="psnp.shtml#psnp1">Basic SNP annotation</a>
 <li> <a href="psnp.shtml#psnp2">Gene-based SNP lookup</a>
 <li> <a href="psnp.shtml#psnp3">Annotation sources</a>
</ul>


<a href="simulate.shtml">29. Simulation tools</a>
<ul>
 <li> <a href="simulate.shtml#sim1">Basic usage</a>
 <li> <a href="simulate.shtml#sim2">Resampling a population</a>
 <li> <a href="simulate.shtml#sim3">Quantitative traits</a>
</ul>


<a href="profile.shtml">30. Profile scoring</a>
<ul>
 <li> <a href="profile.shtml#prof1">Basic usage</a>
 <li> <a href="profile.shtml#prof2">SNP subsets</a>
 <li> <a href="profile.shtml#dose">Dosage data</a>
 <li> <a href="profile.shtml#prof3">Misc options</a>
</ul>

<a href="ids.shtml">31. ID helper</a>
<ul>
 <li> <a href="ids.shtml#ex">Overview/example</a>
 <li> <a href="ids.shtml#intro">Basic usage</a>
 <li> <a href="ids.shtml#check">Consistency checks</a>
 <li> <a href="ids.shtml#alias">Aliases</a>
 <li> <a href="ids.shtml#joint">Joint IDs</a>
 <li> <a href="ids.shtml#lookup">Lookups</a>
 <li> <a href="ids.shtml#replace">Replace values</a>
 <li> <a href="ids.shtml#match">Match files</a>
 <li> <a href="ids.shtml#qmatch">Quick match files</a>
 <li> <a href="ids.shtml#misc">Misc.</a>
</ul>


<a href="res.shtml">32. Resources</a>
<ul>
 <li> <a href="res.shtml#hapmap">HapMap (PLINK format)</a>
 <li> <a href="res.shtml#teach">Teaching materials</a>
 <li> <a href="res.shtml#mmtests">Multimarker tests</a>
 <li> <a href="res.shtml#sets">Gene-set lists</a>
 <li> <a href="res.shtml#glist">Gene range lists</a>
 <li> <a href="res.shtml#attrib">SNP attributes</a>
</ul>

<a href="flow.shtml">33. Flow-chart</a>
<ul>
 <li> <a href="flow.shtml">Order of commands</a>
</ul>

<a href="misc.shtml">34. Miscellaneous</a>
<ul>
 <li> <a href="misc.shtml#opt">Command options/modifiers</a>
 <li> <a href="misc.shtml#output">Association output modifiers</a>
 <li> <a href="misc.shtml#species">Different species</a>
 <li> <a href="misc.shtml#bugs">Known issues</a>
</ul>

<a href="faq.shtml">35. FAQ & Hints</a>
</p>

<a href="gplink.shtml">36. gPLINK</a>
<ul>
 <li> <a href="gplink.shtml">gPLINK mainpage</a>
 <li> <a href="gplink_tutorial/index.html">Tour of gPLINK</a>
 <li> <a href="gplink.shtml#overview">Overview: using gPLINK</a>
 <li> <a href="gplink.shtml#locrem">Local versus remote modes</a>
 <li> <a href="gplink.shtml#start">Starting a new project</a>
 <li> <a href="gplink.shtml#config">Configuring gPLINK</a>
 <li> <a href="gplink.shtml#plink">Initiating PLINK jobs</a>
 <li> <a href="gplink.shtml#view">Viewing PLINK output</a>
 <li> <a href="gplink.shtml#hv">Integration with Haploview</a>
 <li> <a href="gplink.shtml#down">Downloading gPLINK</a></p>
</ul>

</font>
</td><td width=5%>


<td valign="top">


&nbsp;</p>



<h1>Analysis of dosage data</h1>
&nbsp;
</p>

This page describes features to analyse "dosage" SNP datasets, for
example, from imputation packages <a
href="www.stat.auckland.ac.nz/~bbrowning/beagle/beagle.html">BEAGLE</a>
or <a href="www.sph.umich.edu/csg/abecasis/mach/">MACH</a>. The
<tt>--dosage</tt> command will take data in a variety of formats (but
best suited to BEAGLE-style output, with one SNP per line) potentially
compressed and distributed across multiple files, and perform
association tests between the phenotype and the dosage data (expected
allele counts) as well as outputing merged, filtered or hard-called
datasets.

</p>

<a name="basic">
<h2>Basic usage</h2>
</a></p>

The basic usage is 
<h5>
 plink --dosage myfile.dat --fam mydata.fam 
</h5></p>
which will create a file
<pre>
     plink.assoc.dosage
</pre>

which contains the fields

<pre>
     CHR   Chromosome code, if map file specified
     SNP   SNP code
      BP   Base-pair position, if map file specified
      A1   Allele 1 code
      A2   Allele 2 code
     FRQ   Frequency of A1, from dosage data
    INFO   R-squared quality metric / information content
      OR   Odds ratio for association (or BETA for quantitative traits)
      SE   Standard error of effect estimate
       P   p-value for association tests
</pre>

If a MAP file is also specified
<h5>
 plink --dosage myfile.dat --fam mydata.fam --map mymap.map
</h5></p>

then a) extra CHR and BP fields will be reported in the output, b)
only SNPs that are present in the MAP file will be analysed and
reported.

The basic format of a dosage file specifies that each row of the file
corresponds to a SNP (i.e. similar to a transposed PED file, rather
than one individual per row). There are three default columns that
should appear before the dosage data:

<pre>
     SNP  A1  A2  Dosage data ...
</pre>
For example
<pre>
        SNP  A1  A2   F1 I1       F2 I2        F3 I3
     rs0001   A   C   0.98 0.02   1.00 0.00    0.00 0.01 
     rs0002   G   A   0.00 1.00   0.00 0.00    0.99 0.01 
</pre>

In this case, we have data for two SNPs on three individuals. Here,
each genotype is represented by two numbers (alternative
representations can be specified below).  For example, the two numbers
for the first SNP represent the probability of an <tt>A/A</tt>, then
an <tt>A/C</tt> genotype. The probability of a <tt>G/G</tt> is
naturally 1 minus the sum of these.
</p>

Individuals in the dosage data but not the FAM file are ignored
(unless the <tt>noheader</tt> option is specified, see
below). Individuals in the FAM file but not the doseage file are
removed from the dataset.

</p>
Association tests are performed within a linear or logistic regression
framework.  As such, many standard options such as <tt>--covar</tt> or
<tt>--within</tt> can be specified. See the main page on association
for more details.  Not all options are available however: for example,
permutation is not possible with dosage data files.
</p>

The <tt>INFO</tt> metric is calculated based on the entire file, based
on the ratio of empirical and expected variance in dosage.  Values
closer to 1 indicate better expected quality of imputation. Values can
be above 1: note that values much greater than 1 can indicate strong
departure from HWE.

</p>

Optionally, if extra fields exist they can be skipped, via the
<tt>skip0</tt>, <tt>skip1</tt> and <tt>skip2</tt> options (see below):

<pre>
     {skip0}  SNP  {skip1}  A1  A2  {skip2}  Dosage data  ...
</pre>

By default, we expect a header row for each dosage file, that has the
same header fields for the leading columns, and then lists the
<tt>FID</tt> and <tt>IID</tt> codes for the individuals in that file.
If there is no header (<tt>noheader</tt> option), then PLINK assumes
the order and number of individuals in the each dosage file should
correspond to the FAM file (after any exclusions, e.g. from
<tt>--remove</tt>, etc) specifed.
</p>

As described below, dosage data can be represented in a number of
ways. Dosage data can be spread across multiple files: if the
<tt>list</tt> option is specified, e.g.

<h5>
 plink --dosage myfile.lst list --fam mydata.fam
</h5></p>

where <tt>myfile.lst</tt> is a list of file names (full paths can be
specified if the dosage files are in different directories), e.g.

<pre>
     chr1.dose
     chr2.dose
     chr3.dose
     ...
</pre>


</p>
<a name="opt">
<h2>Options</h2>
</a></p>

The options available are as follows:

<pre>
     list          Indicates that the file following <tt>--dosage</tt> is a list of dosage files
                   (as opposed to being a dosage file itself).
     sepheader     Indicates that the ID lists are in separate files (requires 'list')
     noheader      Indicates that there are no headers available

     skip0=N       Number of fields to skip before SNP
     skip1=N       Number of fields to skip between SNP and A1
     skip2=N       Number of fields to skip between A2 and genotype data

     dose1         Dosage data is 0..1, not 0..2 scale
     format=N      Dosage, two probabilities or three (N=1,2,3)

     Z             All input (dosage) files and output files compressed
     Zin           All input files are compressed
     Zout          Output file will be compressed 

     occur         Helper function: count number of occurrences 
</pre>

Most of these options modify the expected format of the input
files. Examples are given in the section below. 


</p>
<a name="examples">
<h2>Examples of different input format options</h2>
</a></p>

Based on the example data file shown above, here are some examples
different of how the data could be differently formatted. That is,
these are all equivalent and will give the same results. The purpose
of these options is to reduce the likely number of steps required in
preparing the data file(s) for analysis.  The major fixed
specification is that the data are essentially in SNP-by-individual
(one row is one SNP) format in all cases.

</p>

<b><em>Split by SNP, single dosage</em></b></p>

Here each file contains all individuals, has a header file and
contains single dosages of the <tt>A1</tt> allele.

</p>

<tt><font color="blue">a1.dose</font></tt>
<pre>
        SNP  A1  A2   F1 I1 F2 I2 F3 I3
     rs0001   A   C   0.02 0.00 1.99
</pre>
<tt><font color="blue">a2.dose</font></tt>
<pre>
        SNP  A1  A2   F1 I1 F2 I2 F3 I3
     rs0002   G   A   1.00 2.00 0.01
</pre>

The command would be

<h5>
plink --fam d.fam  --dosage a.txt list format=1
</h5></p>

where <tt>a.txt</tt> is a text file, with 2 fields, SNP batch and dosage file name

<pre>
     1 a1.dose
     2 a2.dose
</pre>

in which the numeric codes indicate different batches of
SNPs. Obviously, in real examples a given file would likely contain a
very large number of SNPs (e.g. all SNPs for a given chromosome).

</p><b><em>Split by individuals, with some leading nuissance fields</em></b></p>

<tt><font color="blue">b1.dose</font></tt>
<pre>
        SNP  A1  A2   F     R2    F1 I1       F2 I2    
     rs0001   A   C   0.02  0.98  0.98 0.02   1.00 0.00
     rs0002   G   A   0.5   0.23  0.00 1.00   0.00 0.00
</pre>

<tt><font color="blue">b2.dose</font></tt>
<pre>
        SNP  A1  A2  F     R2    F3 I3
     rs0001   A   C  0.02  0.8   0.00 0.01 
     rs0002   G   A  0.5   0.55  0.99 0.01 
</pre>

The command to read these data is then

<h5>
 plink --fam d.fam --dosage b.txt list skip2=2
</h5></p>

where <tt>b.txt</tt> is a text file, with 1 field (file name), as
there is only a single batch of SNPs (i.e. all dosage files contain
the same set of SNPs, in the same order).

<pre>
     b1.dose
     b2.dose
</pre>

The <tt>skip2</tt> option means that PLINK knows to ignore the fields
<tt>F</tt> and <tt>R2</tt> fields.

</p><b><em>Split by SNP and individual, without headers, different
individual order and compressed</em></b></p>

In this third example, the same dataset is spread across four
files. Note how the order of which individuals are in which file, and
the order within the file, changes between different batches of
SNPs. As long as such changes are accurately represented in the
headers (whether these are in the dosage file itself, or in separate
header files, as in this example), this is allowed.
</p>

<tt><font color="blue">c1.dose.gz</font></tt>
<pre>
     rs0001   A   C   0.98 0.02   1.00 0.00
</pre>
<tt><font color="blue">c2.dose.gz</font></tt>
<pre>
     rs0001   A   C   0.00 0.01 
</pre>
<tt><font color="blue">c3.dose.gz</font></tt>
<pre>
     rs0002   G   A   0.00 1.00   
</pre>
<tt><font color="blue">c4.dose.gz</font></tt>
<pre>
     rs0002   G   A   0.99 0.01   0.00 0.00
</pre>

with the accompanying list of IDs in the auxiliary files

</p><tt><font color="blue">c1.lst</font></tt>
<pre>
     F1 I1
     F2 I2
</pre>
<tt><font color="blue">c2.lst</font></tt>
<pre>
     F3 I3
</pre>
<tt><font color="blue">c3.lst</font></tt>
<pre>
     F1 I1
</pre>
<tt><font color="blue">c4.lst</font></tt>
<pre>
     F3 I3
     F2 I2
</pre>

The command to read these data is then

<h5>
 plink --fam d.fam --dosage c.txt list sepheader Zin  --write-dosage
</h5></p>

where <tt>c.txt</tt> is a text file, with 3 fields (SNP batch, file name, separate header)

<pre>
     1 c1.dose.gz c1.lst
     1 c2.dose.gz c2.lst
     2 c3.dose.gz c3.lst
     2 c4.dose.gz c4.lst
</pre>

Note that in this example, the individuals are differently distibuted
between files in the first versus the second batch of SNPs. It is also
not necessary that all individuals are specified -- they will be set
to have a missing datapoint in that case.  

The main constraint is that between files within a particular
genomic-batch, the length and SNP order must be exactly the same.









</td>
<td width=5%>&nbsp;</td>
</tr>
</table>




<hr>
<em>
 This document last modified Wednesday, 25-Jan-2017 11:39:26 EST
</em>


</body>

<HEAD>
<META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
</HEAD>
</html>
