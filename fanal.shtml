<html>
<body>

<head>
<link rel="stylesheet" href="plink.css" type="text/css">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<title>PLINK: Whole genome data analysis toolset</title>
</head>



<!--<html>-->
<!--<title>PLINK</title>-->
<!--<body>-->

<font size="6" color="darkgreen"><b>plink...</b></font>

<div style="position:absolute;right:10px;top:10px;font-size: 
75%"><em>Last original <tt>PLINK</tt> release is <b>v1.07</b>
(10-Oct-2009); <b>PLINK 1.9</b> is now <a href="plink2.shtml"> available</a> for beta-testing</em></div>

<h1>Whole genome association analysis toolset</h1>

<font size="1" color="darkgreen">
<em>
<a href="index.shtml">Introduction</a> |
<a href="contact.shtml">Basics</a> |
<a href="download.shtml">Download</a> |
<a href="reference.shtml">Reference</a> |
<a href="data.shtml">Formats</a> |
<a href="dataman.shtml">Data management</a> |
<a href="summary.shtml">Summary stats</a> |
<a href="thresh.shtml">Filters</a> |
<a href="strat.shtml">Stratification</a> |
<a href="ibdibs.shtml">IBS/IBD</a> |
<a href="anal.shtml">Association</a> |
<a href="fanal.shtml">Family-based</a> |
<a href="perm.shtml">Permutation</a> |
<a href="ld.shtml">LD calcualtions</a> |
<a href="haplo.shtml">Haplotypes</a> |
<a href="whap.shtml">Conditional tests</a> |
<a href="proxy.shtml">Proxy association</a> |
<a href="pimputation.shtml">Imputation</a> |
<a href="dosage.shtml">Dosage data</a> |
<a href="metaanal.shtml">Meta-analysis</a> |
<a href="annot.shtml">Result annotation</a> |
<a href="clump.shtml">Clumping</a> |
<a href="grep.shtml">Gene Report</a> |
<a href="epi.shtml">Epistasis</a> |
<a href="cnv.shtml">Rare CNVs</a> |
<a href="gvar.shtml">Common CNPs</a> |
<a href="rfunc.shtml">R-plugins</a> |
<a href="psnp.shtml">SNP annotation</a> |
<a href="simulate.shtml">Simulation</a> |
<a href="profile.shtml">Profiles</a> |
<a href="ids.shtml">ID helper</a> |
<a href="res.shtml">Resources</a> |
<a href="flow.shtml">Flow chart</a> | 
<a href="misc.shtml">Misc.</a> |
<a href="faq.shtml">FAQ</a> |
<a href="gplink.shtml">gPLINK</a> 
</em></font>
</p>


<table border=0>
<tr>


<td bgcolor="lightblue" valign="top" width=20%>

<font size="1">

<a href="index.shtml">1. Introduction</a> </p>

<a href="contact.shtml">2. Basic information</a> </p>
<ul> 
 <li> <a href="contact.shtml#cite">Citing PLINK</a>
 <li> <a href="contact.shtml#probs">Reporting problems</a>
 <li> <a href="news.shtml">What's new?</a>
 <li> <a href="pdf.shtml">PDF documentation</a>
</ul>


<a href="download.shtml">3. Download and general notes</a> </p>
<ul> 
 <li> <a href="download.shtml#download">Stable download</a>
 <li> <a href="download.shtml#latest">Development code</a>
 <li> <a href="download.shtml#general">General notes</a>
 <li> <a href="download.shtml#msdos">MS-DOS notes</a>
 <li> <a href="download.shtml#nix">Unix/Linux notes</a>
 <li> <a href="download.shtml#compilation">Compilation</a>
 <li> <a href="download.shtml#input">Using the command line</a>
 <li> <a href="download.shtml#output">Viewing output files</a>
 <li> <a href="changelog.shtml">Version history</a>
</ul>

<a href="reference.shtml">4. Command reference table</a> </p>
<ul> 
 <li> <a href="reference.shtml#options">List of options</a>
 <li> <a href="reference.shtml#output">List of output files</a> 
 <li> <a href="newfeat.shtml">Under development</a>
</ul>


<a href="data.shtml">5. Basic usage/data formats</a> 
<ul> 
 <li> <a href="data.shtml#plink">Running PLINK</a>
 <li> <a href="data.shtml#ped">PED files</a>
 <li> <a href="data.shtml#map">MAP files</a>
 <li> <a href="data.shtml#tr">Transposed filesets</a>
 <li> <a href="data.shtml#long">Long-format filesets</a>
 <li> <a href="data.shtml#bed">Binary PED files</a>
 <li> <a href="data.shtml#pheno">Alternate phenotypes</a>
 <li> <a href="data.shtml#covar">Covariate files</a>
 <li> <a href="data.shtml#clst">Cluster files</a>
 <li> <a href="data.shtml#sets">Set files</a>
</ul>

<a href="dataman.shtml">6. Data management</a> </p>
<ul>
 <li>  <a href="dataman.shtml#recode">Recode</a>
 <li>  <a href="dataman.shtml#recode">Reorder</a>
 <li>  <a href="dataman.shtml#snplist">Write SNP list</a>
 <li>  <a href="dataman.shtml#updatemap">Update SNP map</a>
 <li>  <a href="dataman.shtml#updateallele">Update allele information</a>
 <li>  <a href="dataman.shtml#refallele">Force reference allele</a>
 <li>  <a href="dataman.shtml#updatefam">Update individuals</a>
 <li>  <a href="dataman.shtml#wrtcov">Write covariate files</a>
 <li>  <a href="dataman.shtml#wrtclst">Write cluster files</a>
 <li>  <a href="dataman.shtml#flip">Flip strand</a>
 <li>  <a href="dataman.shtml#flipscan">Scan for strand problem</a>
 <li>  <a href="dataman.shtml#merge">Merge two files</a>
 <li>  <a href="dataman.shtml#mergelist">Merge multiple files</a>
 <li>  <a href="dataman.shtml#extract">Extract SNPs</a>
 <li>  <a href="dataman.shtml#exclude">Remove SNPs</a>
 <li>  <a href="dataman.shtml#zero">Zero out sets of genotypes</a>
 <li>  <a href="dataman.shtml#keep">Extract Individuals</a>
 <li>  <a href="dataman.shtml#remove">Remove Individuals</a>
 <li>  <a href="dataman.shtml#filter">Filter Individuals</a>
 <li>  <a href="dataman.shtml#attrib">Attribute filters</a>
 <li>  <a href="dataman.shtml#makeset">Create a set file</a>
 <li>  <a href="dataman.shtml#tabset">Tabulate SNPs by sets</a>
 <li>  <a href="dataman.shtml#snp-qual">SNP quality scores</a>
 <li>  <a href="dataman.shtml#geno-qual">Genotypic quality scores</a>
</ul>
 
<a href="summary.shtml">7. Summary stats</a>
<ul>
 <li> <a href="summary.shtml#missing">Missingness</a>
 <li> <a href="summary.shtml#oblig_missing">Obligatory missingness</a>
 <li> <a href="summary.shtml#clustermissing">IBM clustering</a>
 <li> <a href="summary.shtml#testmiss">Missingness by phenotype</a>
 <li> <a href="summary.shtml#mishap">Missingness by genotype</a>
 <li> <a href="summary.shtml#hardy">Hardy-Weinberg</a>
 <li> <a href="summary.shtml#freq">Allele frequencies</a>
 <li> <a href="summary.shtml#prune">LD-based SNP pruning</a>
 <li> <a href="summary.shtml#mendel">Mendel errors</a>
 <li> <a href="summary.shtml#sexcheck">Sex check</a>
 <li> <a href="summary.shtml#pederr">Pedigree errors</a>
</ul>

<a href="thresh.shtml">8. Inclusion thresholds</a>
<ul>
 <li> <a href="thresh.shtml#miss2">Missing/person</a>
 <li> <a href="thresh.shtml#maf">Allele frequency</a>
 <li> <a href="thresh.shtml#miss1">Missing/SNP</a>
 <li> <a href="thresh.shtml#hwd">Hardy-Weinberg</a>
 <li> <a href="thresh.shtml#mendel">Mendel errors</a>
</ul>


<a href="strat.shtml">9. Population stratification</a>
<ul>
 <li> <a href="strat.shtml#cluster">IBS clustering</a>
 <li> <a href="strat.shtml#permtest">Permutation test</a>
 <li> <a href="strat.shtml#options">Clustering options</a>
 <li> <a href="strat.shtml#matrix">IBS matrix</a>
 <li> <a href="strat.shtml#mds">Multidimensional scaling</a>
 <li> <a href="strat.shtml#outlier">Outlier detection</a>
</ul>

<a href="ibdibs.shtml">10. IBS/IBD estimation</a>
<ul>
 <li> <a href="ibdibs.shtml#genome">Pairwise IBD</a>
 <li> <a href="ibdibs.shtml#inbreeding">Inbreeding</a>
 <li> <a href="ibdibs.shtml#homo">Runs of homozygosity</a>
 <li> <a href="ibdibs.shtml#segments">Shared segments</a>
</ul>


<a href="anal.shtml">11. Association</a>
<ul>
 <li> <a href="anal.shtml#cc">Case/control</a>
 <li> <a href="anal.shtml#fisher">Fisher's exact</a>
 <li> <a href="anal.shtml#model">Full model</a>
 <li> <a href="anal.shtml#strat">Stratified analysis</a>
 <li> <a href="anal.shtml#homog">Tests of heterogeneity</a>
 <li> <a href="anal.shtml#hotel">Hotelling's T(2) test</a>
 <li> <a href="anal.shtml#qt">Quantitative trait</a>
 <li> <a href="anal.shtml#qtmeans">Quantitative trait means</a>
 <li> <a href="anal.shtml#qtgxe">Quantitative trait GxE</a>
 <li> <a href="anal.shtml#glm">Linear and logistic models</a>
 <li> <a href="anal.shtml#set">Set-based tests</a>
 <li> <a href="anal.shtml#adjust">Multiple-test correction</a>
</ul>

<a href="fanal.shtml">12. Family-based association</a>
<ul>
 <li> <a href="fanal.shtml#tdt">TDT</a>
 <li> <a href="fanal.shtml#ptdt">ParenTDT</a>
 <li> <a href="fanal.shtml#poo">Parent-of-origin</a>
 <li> <a href="fanal.shtml#dfam">DFAM test</a>
 <li> <a href="fanal.shtml#qfam">QFAM test</a>
</ul>

<a href="perm.shtml">13. Permutation procedures</a>
<ul>
 <li> <a href="perm.shtml#perm">Basic permutation</a>
 <li> <a href="perm.shtml#aperm">Adaptive permutation</a>
 <li> <a href="perm.shtml#mperm">max(T) permutation</a>
 <li> <a href="perm.shtml#rank">Ranked permutation</a>
 <li> <a href="perm.shtml#genedropmodel">Gene-dropping</a>
 <li> <a href="perm.shtml#cluster">Within-cluster</a>
 <li> <a href="perm.shtml#mkphe">Permuted phenotypes files</a>
</ul>

<a href="ld.shtml">14. LD calculations</a>
<ul>
 <li> <a href="ld.shtml#ld1">2 SNP pairwise LD</a>
 <li> <a href="ld.shtml#ld2">N SNP pairwise LD</a>
 <li> <a href="ld.shtml#tags">Tagging options</a>
 <li> <a href="ld.shtml#blox">Haplotype blocks</a>
</ul>

<a href="haplo.shtml">15. Multimarker tests</a>
<ul>
 <li> <a href="haplo.shtml#hap1">Imputing haplotypes</a>
 <li> <a href="haplo.shtml#precomputed">Precomputed lists</a>
 <li> <a href="haplo.shtml#hap2">Haplotype frequencies</a>
 <li> <a href="haplo.shtml#hap3">Haplotype-based association</a>
 <li> <a href="haplo.shtml#hap3c">Haplotype-based GLM tests</a>
 <li> <a href="haplo.shtml#hap3b">Haplotype-based TDT</a>
 <li> <a href="haplo.shtml#hap4">Haplotype imputation</a>
 <li> <a href="haplo.shtml#hap5">Individual phases</a>
</ul>

<a href="whap.shtml">16. Conditional haplotype tests</a>
<ul>
 <li> <a href="whap.shtml#whap1">Basic usage</a>
 <li> <a href="whap.shtml#whap2">Specifying type of test</a>
 <li> <a href="whap.shtml#whap3">General haplogrouping</a>
 <li> <a href="whap.shtml#whap4">Covariates and other SNPs</a>
</ul>

<a href="proxy.shtml">17. Proxy association</a>
<ul>
 <li> <a href="proxy.shtml#proxy1">Basic usage</a>
 <li> <a href="proxy.shtml#proxy2">Refining a signal</a>
 <li> <a href="proxy.shtml#proxy2b">Multiple reference SNPs</a>
 <li> <a href="proxy.shtml#proxy3">Haplotype-based SNP tests</a>
</ul>

<a href="pimputation.shtml">18. Imputation (beta)</a>
<ul>
 <li> <a href="pimputation.shtml#impute1">Making reference set</a>
 <li> <a href="pimputation.shtml#impute2">Basic association test</a>
 <li> <a href="pimputation.shtml#impute3">Modifying parameters</a>
 <li> <a href="pimputation.shtml#impute4">Imputing discrete calls</a>
 <li> <a href="pimputation.shtml#impute5">Verbose output options</a>
</ul>

<a href="dosage.shtml">19. Dosage data</a>
<ul>
 <li> <a href="dosage.shtml#format">Input file formats</a>
 <li> <a href="dosage.shtml#assoc">Association analysis</a>
 <li> <a href="dosage.shtml#output">Outputting dosage data</a>
</ul>

<a href="metaanal.shtml">20. Meta-analysis</a>
<ul>
 <li> <a href="metaanal.shtml#basic">Basic usage</a>
 <li> <a href="metaanal.shtml#opt">Misc. options</a>
</ul>

<a href="annot.shtml">21. Annotation</a>
<ul>
 <li> <a href="annot.shtml#basic">Basic usage</a>
 <li> <a href="annot.shtml#opt">Misc. options</a>
</ul>

<a href="clump.shtml">22. LD-based results clumping</a>
<ul>
 <li> <a href="clump.shtml#clump1">Basic usage</a>
 <li> <a href="clump.shtml#clump2">Verbose reporting</a>
 <li> <a href="clump.shtml#clump3">Combining multiple studies</a>
 <li> <a href="clump.shtml#clump4">Best single proxy</a>
</ul>

<a href="grep.shtml">23. Gene-based report</a>
<ul>
 <li> <a href="grep.shtml#grep1">Basic usage</a>
 <li> <a href="grep.shtml#grep2">Other options</a>
</ul>

<a href="epi.shtml">24. Epistasis</a>
<ul>
 <li> <a href="epi.shtml#snp">SNP x SNP</a>
 <li> <a href="epi.shtml#case">Case-only</a>
 <li> <a href="epi.shtml#gene">Gene-based</a>
</ul>

<a href="cnv.shtml">25. Rare CNVs</a>
<ul>
 <li> <a href="cnv.shtml#format">File format</a>
 <li> <a href="cnv.shtml#maps">MAP file construction</a>
 <li> <a href="cnv.shtml#loading">Loading CNVs</a>
 <li> <a href="cnv.shtml#olap_check">Check for overlap</a>
 <li> <a href="cnv.shtml#type_filter">Filter on type </a>
 <li> <a href="cnv.shtml#gene_filter">Filter on genes </a> 
 <li> <a href="cnv.shtml#freq_filter">Filter on frequency </a>
 <li> <a href="cnv.shtml#burden">Burden analysis</a>
 <li> <a href="cnv.shtml#burden2">Geneset enrichment</a>
 <li> <a href="cnv.shtml#assoc">Mapping loci</a>
 <li> <a href="cnv.shtml#reg-assoc">Regional tests</a>
 <li> <a href="cnv.shtml#qt-assoc">Quantitative traits</a>
 <li> <a href="cnv.shtml#write_cnvlist">Write CNV lists</a>
 <li> <a href="cnv.shtml#report">Write gene lists</a>
 <li> <a href="cnv.shtml#groups">Grouping CNVs </a>
</ul>

<a href="gvar.shtml">26. Common CNPs</a>
<ul>
 <li> <a href="gvar.shtml#cnv2"> CNPs/generic variants</a>
 <li> <a href="gvar.shtml#cnv2b"> CNP/SNP association</a>
</ul>


<a href="rfunc.shtml">27. R-plugins</a>
<ul>
 <li> <a href="rfunc.shtml#rfunc1">Basic usage</a>
 <li> <a href="rfunc.shtml#rfunc2">Defining the R function</a>
 <li> <a href="rfunc.shtml#rfunc2b">Example of debugging</a>
 <li> <a href="rfunc.shtml#rfunc3">Installing Rserve</a>
</ul>


<a href="psnp.shtml">28. Annotation web-lookup</a>
<ul>
 <li> <a href="psnp.shtml#psnp1">Basic SNP annotation</a>
 <li> <a href="psnp.shtml#psnp2">Gene-based SNP lookup</a>
 <li> <a href="psnp.shtml#psnp3">Annotation sources</a>
</ul>


<a href="simulate.shtml">29. Simulation tools</a>
<ul>
 <li> <a href="simulate.shtml#sim1">Basic usage</a>
 <li> <a href="simulate.shtml#sim2">Resampling a population</a>
 <li> <a href="simulate.shtml#sim3">Quantitative traits</a>
</ul>


<a href="profile.shtml">30. Profile scoring</a>
<ul>
 <li> <a href="profile.shtml#prof1">Basic usage</a>
 <li> <a href="profile.shtml#prof2">SNP subsets</a>
 <li> <a href="profile.shtml#dose">Dosage data</a>
 <li> <a href="profile.shtml#prof3">Misc options</a>
</ul>

<a href="ids.shtml">31. ID helper</a>
<ul>
 <li> <a href="ids.shtml#ex">Overview/example</a>
 <li> <a href="ids.shtml#intro">Basic usage</a>
 <li> <a href="ids.shtml#check">Consistency checks</a>
 <li> <a href="ids.shtml#alias">Aliases</a>
 <li> <a href="ids.shtml#joint">Joint IDs</a>
 <li> <a href="ids.shtml#lookup">Lookups</a>
 <li> <a href="ids.shtml#replace">Replace values</a>
 <li> <a href="ids.shtml#match">Match files</a>
 <li> <a href="ids.shtml#qmatch">Quick match files</a>
 <li> <a href="ids.shtml#misc">Misc.</a>
</ul>


<a href="res.shtml">32. Resources</a>
<ul>
 <li> <a href="res.shtml#hapmap">HapMap (PLINK format)</a>
 <li> <a href="res.shtml#teach">Teaching materials</a>
 <li> <a href="res.shtml#mmtests">Multimarker tests</a>
 <li> <a href="res.shtml#sets">Gene-set lists</a>
 <li> <a href="res.shtml#glist">Gene range lists</a>
 <li> <a href="res.shtml#attrib">SNP attributes</a>
</ul>

<a href="flow.shtml">33. Flow-chart</a>
<ul>
 <li> <a href="flow.shtml">Order of commands</a>
</ul>

<a href="misc.shtml">34. Miscellaneous</a>
<ul>
 <li> <a href="misc.shtml#opt">Command options/modifiers</a>
 <li> <a href="misc.shtml#output">Association output modifiers</a>
 <li> <a href="misc.shtml#species">Different species</a>
 <li> <a href="misc.shtml#bugs">Known issues</a>
</ul>

<a href="faq.shtml">35. FAQ & Hints</a>
</p>

<a href="gplink.shtml">36. gPLINK</a>
<ul>
 <li> <a href="gplink.shtml">gPLINK mainpage</a>
 <li> <a href="gplink_tutorial/index.html">Tour of gPLINK</a>
 <li> <a href="gplink.shtml#overview">Overview: using gPLINK</a>
 <li> <a href="gplink.shtml#locrem">Local versus remote modes</a>
 <li> <a href="gplink.shtml#start">Starting a new project</a>
 <li> <a href="gplink.shtml#config">Configuring gPLINK</a>
 <li> <a href="gplink.shtml#plink">Initiating PLINK jobs</a>
 <li> <a href="gplink.shtml#view">Viewing PLINK output</a>
 <li> <a href="gplink.shtml#hv">Integration with Haploview</a>
 <li> <a href="gplink.shtml#down">Downloading gPLINK</a></p>
</ul>

</font>
</td><td width=5%>


<td valign="top">


&nbsp;</p>



<h1>Family-based association analysis</h1>
</p>

The main focus of PLINK is for population-based samples. There is some 
support for family-based analyses however, described in this section, 
for disease traits and quantitative traits. 

</p>

<a name="tdt">
<h2>Family-based association (TDT)</h2>
</a></p>

<tt>PLINK</tt> supports basic family-based association testing for disease 
traits, using the TDT and a variant of this test that also incorporates 
parental phenotype information, the <em>parenTDT</em>.
</p>

To run a basic TDT analysis for family data:
<h5>
	plink --file mydata --tdt
</h5></p>
which generates the file
<pre>
     plink.tdt
</pre>
If permutation has been requested, then either 
<pre>
     plink.tdt.perm
</pre>
or
<pre>
     plink.tdt.mperm
</pre>
will be generated also.  The main output file, <tt>plink.tdt</tt>, 
contains the following fields:
<pre>
     CHR         Chromosome number
     SNP         SNP identifier
     A1          Minor allele code
     A2          Major allele code
     T           Transmitted minor allele count
     U           Untransmitted allele count
     OR          TDT odds ratio
     CHISQ       TDT chi-square statistic
     P           TDT asymptotic p-value
     A:U_PAR     Parental discordance counts
     CHISQ_PAR   Parental discordance statistic
     P_PAR       Parental discordance asymptotic p-value
     CHISQ_COM   Combined test statistic
     P_COM       Combined test asymptotic p-value
</pre>

If the <tt>--ci</tt> option has been requested, then two additional 
fields will appear after <tt>TDT_OR</tt>:

<pre>
     L95         Lower 95% confidence interval for TDT odds ratio
     U95         Upper 95% confidence interval for TDT odds ratio
</pre>
(naturally, if a value other than 0.95 was used as the argument for the 
<tt>--ci</tt> option, it will appear here instead.)</p>

The TDT statistic is calculated simply as
<pre>
     (b-c)^2 / (b+c)
</pre>
where <tt>b</tt> and <tt>c</tt> are the number of transmitted and
untransmitted alleles as shown in <tt>plink.tdt</tt>; under the 
null, it is distributed as a 1df chi-squared.
</p>

The parental discordance test is based on counting the number of 
alleles in affected versus unaffected parents, treating each 
nuclear family parental pair as a matched pair. These counts 
can be combined with the <tt>T</tt> and <tt>U</tt> counts of the 
basic TDT to give a combined test statistic, also shown in the output.
The parenTDT assumes homogeneity within families rather than between 
families, in terms of population stratification. If parents are measured 
on the phenotype, then this test can add considerable power to 
family-based association analysis, whilst providing a strong degree (but
not complete) protection against population stratification. The increase
in power will depend on the proportion of parents that are discordant 
for the disease. This approach is described in Purcell <em>et al</em> 
AJHG (2005). <tt>PLINK</tt> uses a more simple approach to calculate the  
<tt>PAR</tt> and <tt>COM</tt> statistics, however: if
<pre>
                   Unaffeced parent
                   A/A   A/B   B/B
     Affected A/A   -     p     r
      parent  A/B   x     -     q
              B/B   z     y     -
</pre>
i.e. such that the <tt>A:U_PAR</tt> fields represents <tt>p+q+2r : x+y+2z</tt>, 
then
<pre>
     PAR = ( (p+q+2r) - (x+y+2z) )^2
            / ( p+q+x+y+4(r+z) )
</pre>
and
<pre>
     COM =  ( ( b+p+q+2r ) - ( c+x+y+2z ) )^2 
             / ( b+p+q+c+x+y+4(r+z) )
</pre>
Both statistics follow a 1 df chi-squared distribution under the null.
</p>
When running the <tt>--tdt</tt> option, <tt>PLINK</tt> will first 
perform a check for Mendel errors and make missing the offending 
genotypes.

</p>

Using the <tt>--tdt</tt> option, if permutation is requested (using 
either <tt>--perm</tt> or <tt>--mperm</tt>) a file entitled either
<pre>
     plink.tdt.perm
</pre>
or
<pre>
     plink.tdt.mperm
</pre>
will be generated: the empirical p-value will be based on the standard TDT 
test. The permutation procedure will flip transmitted/untransmitted status 
constantly for all SNPs for a given family, thereby preserving the LD and 
linkage information between markers and siblings.



<a name="ptdt">
<h2>parenTDT</h2>
</a></p>

The parenTDT, described in the paragraph above, is 
automatically included when using the <tt>--tdt</tt> option. These 
alternate commands generate the same output as for the <tt>--tdt</tt> 
command, described above, except the permutation is based not on the 
standard TDT, but either the parenTDT if using the option
<h5>
	plink --file mydata --parentdt1
</h5></p>
or, the combined test (TDT and parenTDT) if using the option
<h5>
	plink --file mydata --parentdt2
</h5></p>


<a name="poo">
<h2>Parent of origin analysis</h2>
</a></p>

When performing family-based TDT analysis, it is possible to 
separately consider transmissions from heterozygous fathers 
versus heterozygous mothers to affected offspring. This is performed
by adding the <tt>--poo</tt> to request parent-of-origin analysis:
<h5>
plink --file mydata --tdt --poo
</h5></p>
which generates the file <tt>plink.tdt.poo</tt>.  If permutation is also requested, 
this also generates the file <tt>plink.tdt.poo.perm</tt> or <tt>plink.tdt.poo.mperm</tt>, 
depending which permutation procedure is used. The main output file has the following 
format:
<pre>
     CHR        Chromosome number
     SNP        SNP identifier
     A1:A2      Allele 1 : allele 2 codes
     T:U_PAT    Paternal transmitted : untransmitted counts
     OR_PAT     Paternal odds ratio
     CHISQ_PAT  Paternal chi-squared test 
     T:U_MAT    Maternal, as above
     OR_MAT     Matneral, as above
     CHISQ_MAT  Maternal, as above
     Z_POO      Z score for difference in paternal versus maternal odds ratios
     P_POO      Asymptotic p-value for parent-of-origin test
</pre>

If permutation is requested, the default test statistic is the absolute value of the Z 
score for the parent-of-origin test (i.e. making a two-sided test). The flags 
<tt>--pat</tt> and <tt>--mat</tt> indicate that the permutation statistic should
be the paternal TDT chi-squared statistics, or the maternal statistic, instead.
</p>

<strong>NOTE</strong> When both parents are heterozygous, these ambiguous transmissions 
are counted as 0.5 for both mother and father -- this is why the T:U counts will often 
not be whole numbers.
</p>


<a name="dfam">
<h2>DFAM: family-based association for disease traits</h2>
</a></p>

The DFAM procedure in PLINK implements the sib-TDT and also allows for
unrelated individuals to be included (via a clustered-analysis using
the Cochran-Mantel-Haesnzel). To perform this test:

<h5>
 plink --bfile mydata --dfam 
</h5></p>
which generates the file
<pre>
     plink.dfam
</pre>
which contains the fields
<pre>
     CHR        Chromosome code
     SNP        SNP identifier
     A1:A2      Minor and major allele codes
     OBS        Number of observed minor alleles 
     EXP        Number of expected minor alleles
     CHISQ      Chi-squared test statistic
     P          Asymptotic p-value
</pre>

This test can therefore be used to combine discordant sibship data,
parent-offspring trio data and unrelated case/control data in a single
analysis.

</p><strong>NOTE</strong> If you are analysing a sibling-only sample (i.e. 
no parents) then also add the <tt>--nonfounders</tt> option; otherwise, 
all SNPs will be pruned out at the filtering stage, as PLINK will by 
default only consider founder alleles when calculating allele frequency, 
Hardy-Weinberg, etc.



<a name="qfam">
<h2>QFAM: family-based association tests for quantitative traits</h2>
</a></p>

PLINK offers a somewhat ad-hoc procedure to perform family-based tests of 
association with quantitative phenotypes: the QFAM procedure, which uses 
permutation to account for the dependence between related individuals.  
It adopts the between/within model as used by Fulker et al (1999, AJHG) 
and Abecasis et al (2000, AJHG) as implemented in the QTDT package. 
However, rather than fitting a maximum likelihood variance components 
model, as QTDT does, PLINK performs a simple linear regression of 
phenotype on genotype, but then uses a special permutation procedure to 
correct for family structure. 
</p>
There are several ways to run QFAM: a total association test (between and 
within components)
<h5> 
 plink --bfile mydata --qfam-total --mperm 100000
</h5></p>
or a within-family test
<h5> 
 plink --bfile mydata --qfam --mperm 100000
</h5></p>
or a test including parental phenotypes
<h5> 
 plink --bfile mydata --qfam-parents --mperm 100000
</h5></p>
(Also, <tt>--qfam-between</tt> will look only at the between-family 
component of association).

</p><strong>NOTE</strong> In all cases above, we have used 
<tt>--mperm</tt> to specify permutation; adaptive permutation can 
also be used with QFAM (<tt>--perm</tt>). Permutation is necessary for 
the QFAM test.
</p>

The columns in the QFAM permutation result files are:
<pre>
     CHR     Chromosome code
     SNP     SNP identifier
     STAT    Test statistic (ignore)
     EMP1    Pointwise empirical p-value
     NP      Number of permutations performed
</pre>

The columns in the non-permutation file (e.g. <tt>plink.qfam.total</tt>, if <tt>plink.qfam.total.mperm</tt>
contains the permuted results) are as follows:
<pre>
     CHR     Chromosome code
     SNP     SNP identifier
     A1      Minor allele (corresponds to beta given below; absent in earlier PLINK releases)
     TEST    Type of test, <tt>TOT</tt>, <tt>WITH</tt> and <tt>BET</tt>
     NMISS   Number of non-missing individuals in analysis
     BETA    Regression coefficient
     STAT    Test statistic (ignore; not corrected for family-structure)
     P       Asymptotic p-value (ignore; use empirical p-value)
</pre>
These results are from a standard <tt>--linear</tt> type analysis, i.e. which ignores family structure. 
They are displayed so that the direction of effect may be determined (from the <tt>BETA</tt>) -- but 
otherwise, only the empirical p-value from the permuted results file should be looked at.


</p>

The B and W components are calcalated using parental genotypes if 
they are available for both parents, otherwise siblings are used. 
Singletons can be included in this analysis (i.e. B=G and W=0 for them): 
for example, the scores are shown below for a few configurations, when 
parents are available:
<pre>
     <b>Genotype     G</b>
     AA           1
     Aa           0
     aa          -1

     B = ( Pat + Mat ) / 2
     W = G - B
 
     <b>Pat     Mat     Offspring     G     B     W</b>

     AA      AA      AA            1     1     0

     Aa      AA      AA            1     0.5   0.5
     Aa      AA      Aa            0     0.5   -0.5

     aa      AA      Aa            0     0     0

     etc
</pre>


</p>


The QFAM permutation procedure breaks down the genotypes into between 
(B) and within (W) components, permutes them independently (i.e. at the 
family level, either swapping the B component for one family with another 
family, or flipping the sign of all W's in a family with 50:50 chance) 
and then (for the total association test) reconstructs the individual 
level "genotypes" as the sum of the 
new B's and W's  i.e:
<pre>
     1) G -> B + W (individual-level)

     2a) Permute B (family-level) -> B'
     2b) Permute W (family-level) -> W'

     3) B' + W' -> G' (individual-level)
</pre>

The logic is that we know how to permute both B and W separately whilst
maintaining the familial structural component, and they are orthogonal
components, so we should permute them separately, but then recombine them
as a single individual-level genotypic score.
</p>

<strong>NOTE</strong> The total <tt>--qfam-total</tt> test is designed to 
extract all association information from a family-based sample, 
controlling for relatedness: it is not robust to stratification. Use the 
<tt>--qfam</tt> for a strictly within family test.

</p>

In many circumstances, the standard QTDT as implemented in Goncalo 
Abecasis' <a href="http://www.sph.umich.edu/csg/abecasis/QTDT/">QTDT</a> 
program will perhaps be more appropriate. The disadvantages of the QFAM 
procedure are 
<ul>
 <li> that it uses permutation and so is slower
 <li> appears to be slightly less powerful when there is a higher residual 
correlation 
</ul>
On the plus side, the advantages of the QFAM procedure are 
<ul>
 <li> that is uses permutation and so is appropriate for non-normal  
phenotypes; it could also be used for disease phenotypes, although it will 
not be appropriate for affected-only TDT style designs
 <li> that it can be applied to genome-wide data easily (albeit not 
necessarily quickly)
</ul>

<strong>Technical note</strong> As a technical point: when permuting 
genotype between families in this way, one has to be careful with missing 
genotype data, particularly in the instance in which a family is 
completely missing. Because a missing B component cannot be recombined 
with a non-missing W component, and vice versa, this process would tend 
to increase the amount of missingness in permutations versus the original 
data.
</p>
One could exclude individuals with missing genotypes first and 
permute separately for each SNP, but this would no longer maintain 
the correlation between SNPs (and require more computation). Instead, we 
use the following scheme. We permute once per replicate (e.g. a table of 
F (original family) and F' (permuted family), true and permuted 
families). e.g.  but let's say that 2 is missing their B component 
(denoted 2*)
For example:
<pre>
     F  F'
     0  5
     1  2*  <- remove ?
     2* 4   <- remove ?
     3  1
     4  0
     5  3
</pre>

This would knock out families 1 and 2 from the permutation. We therefore 
permute once to create a single table for permutation for all SNPs, but 
then resursively edit the table on a SNP-by-SNP basis, to regroup the 
missing families, by swapping missing F' families: in this case, swap 2* 
with 4 (the other partner of 2*), e.g.
<pre>
     F  F'
     0  5
     1  4
     2* 2* <- remove
     3  1
     4  0
     5  3
</pre>

So now we have a permuted sample but the total level of missingness is the
same. This procedure still generates valid, completely random permutations 
of the non-missing genotype data and trys to maintain as much of the  
correlation between SNPs as possible (i.e. as typically only a small % of  
genotypes are missing and so we do not need to edit the table much).

</td>
<td width=5%>&nbsp;</td>
</tr>
</table>




<hr>
<em>
 This document last modified Wednesday, 25-Jan-2017 11:39:26 EST
</em>


</body>

<HEAD>
<META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
</HEAD>

</html>
